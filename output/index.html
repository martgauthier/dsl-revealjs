
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Reveal DSL</title>
  <link rel="stylesheet" href="./public/reveal/dist/reveal.css">
  <link rel="stylesheet" href="./public/reveal/plugin/highlight/monokai.css">
  <script src="./public/reveal/dist/reveal.js"></script>
  <script src="./public/reveal/plugin/highlight/highlight.js"></script>
  <script src="./public/mathjax/tex-chtml.js"></script>
  <script src="https://unpkg.com/mathjs/lib/browser/math.js"></script>
  

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js/plugin/highlight/monokai.css">
  

  
  <style>
  :root {
        --r-block-margin: 20px;
        --r-code-font: monospace;
    }
        
    .reveal ul {
      display: inline-block;
      text-align: left;
    }
    
    .vertical-frame {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    .horizontal-frame {
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 10px;
    }
    .reveal pre {
            display: block;
            position: relative;
            width: 90%;
            margin: var(--r-block-margin) auto;
            text-align: left;
            font-size: 1em;
            font-family: var(--r-code-font);
            line-height: 1.2em;
            word-wrap: break-word;
            box-shadow: 0px 5px 15px rgba(0, 0, 0, 0.15);
        }

        .reveal code {
            font-family: var(--r-code-font);
            text-transform: none;
            tab-size: 2;
        }

        .reveal pre code {
            display: block;
            padding: 5px;
            overflow: auto;
            max-height: 400px;
            word-wrap: normal;
        }

        .reveal .code-wrapper {
            white-space: normal;
        }

        .reveal .code-wrapper code {
            white-space: pre;
        }
  </style>

</head>
<body>

<div class="reveal">
  <div class="slides">
    <section>
                <h1>Final test</h1>

    <canvas id="plot-n9aw6i7xbe" width="720" height="480"></canvas>

    <script>
      (function() {
        const exprs = [math.compile("x^2"),math.compile("sin(x)"),math.compile("exp(x)")];

        const xmin = -3;
        const xmax = 3;
        const samples = 60;

        const xs = [];
        const ys = exprs.map(() => []);

        for (let i = 0; i <= samples; i++) {
          const x = xmin + (i / samples) * (xmax - xmin);
          xs.push(x);
          exprs.forEach((e, idx) => {
            ys[idx].push(e.evaluate({ x }));
          });
        }

        const canvas = document.getElementById("plot-n9aw6i7xbe");
        const ctx = canvas.getContext("2d");

        const padding = 70;
        const w = canvas.width - 2 * padding;
        const h = canvas.height - 2 * padding;

        const allY = ys.flat();
        const ymin = Math.min(...allY);
        const ymax = Math.max(...allY);

        const mapX = x =>
          padding + ((x - xmin) / (xmax - xmin)) * w;

        const mapY = y =>
          padding + h - ((y - ymin) / (ymax - ymin)) * h;

        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.font = "14px sans-serif";
        ctx.strokeStyle = "#888";
        ctx.fillStyle = "#ccc";

        // Axes passant par (0,0)
        ctx.strokeStyle = "#aaa";
        ctx.lineWidth = 1;
        
        // Axe Y (x = 0)
        if (xmin <= 0 && xmax >= 0) {
          const x0 = mapX(0);
          ctx.beginPath();
          ctx.moveTo(x0, padding);
          ctx.lineTo(x0, padding + h);
          ctx.stroke();
        }
        
        // Axe X (y = 0)
        if (ymin <= 0 && ymax >= 0) {
          const y0 = mapY(0);
          ctx.beginPath();
          ctx.moveTo(padding, y0);
          ctx.lineTo(padding + w, y0);
          ctx.stroke();
        }
        
        // Cadre du graphe
        /*ctx.strokeStyle = "#555";
        ctx.strokeRect(padding, padding, w, h);*/

        // Graduations
        const ticks = 5;

        for (let i = 0; i <= ticks; i++) {
          const x = xmin + (i / ticks) * (xmax - xmin);
          const px = mapX(x);
          ctx.fillText(x.toFixed(1), px - 12, padding + h + 22);
        }

        for (let i = 0; i <= ticks; i++) {
          const y = ymin + (i / ticks) * (ymax - ymin);
          const py = mapY(y);
          ctx.fillText(y.toFixed(1), padding - 48, py + 4);
        }

        // UnitÃ©s
        ctx.fillText("x (s)", padding + w / 2 - 15, canvas.height - 20);

        ctx.save();
        ctx.translate(20, padding + h / 2 + 20);
        ctx.rotate(-Math.PI / 2);
        ctx.fillText("f(x) (f(s))", 0, 0);
        ctx.restore();

        // Courbes
        const colors = ["red", "blue", "green", "orange", "purple"];

        ys.forEach((curve, idx) => {
          ctx.strokeStyle = colors[idx % colors.length];
          ctx.lineWidth = 2;
          ctx.beginPath();

          curve.forEach((y, i) => {
            const cx = mapX(xs[i]);
            const cy = mapY(y);
            i === 0 ? ctx.moveTo(cx, cy) : ctx.lineTo(cx, cy);
          });

          ctx.stroke();
        });
      })();
    </script>
  
              </section>
  </div>
</div>

<!-- Reveal JS -->
<script src="https://cdn.jsdelivr.net/npm/reveal.js@5/dist/reveal.js"></script>
<script src="https://cdn.jsdelivr.net/npm/reveal.js@5/plugin/highlight/highlight.js"></script>
<!-- Script pour les animations de replace : -->
<script>
const replaceMemory = new Map();

function rememberInitialState(el) {
  if (replaceMemory.has(el)) return;

  if (el.tagName === 'IMG') {
    replaceMemory.set(el, el.src);
  } else if (el.tagName === 'VIDEO') {
    const source = el.querySelector('source');
    replaceMemory.set(el, source ? source.src : null);
  } else {
    replaceMemory.set(el, el.textContent);
  }
}

function restoreInitialState(el) {
  if (!replaceMemory.has(el)) return;

  const value = replaceMemory.get(el);

  if (el.tagName === 'IMG') {
    el.src = value;
  } else if (el.tagName === 'VIDEO') {
    const source = el.querySelector('source');
    if (source && value) {
      source.src = value;
      el.load();
    }
  } else {
    el.textContent = value;
  }
}

Reveal.on('fragmentshown', e => {
  const f = e.fragment;
  if (f.dataset.replaceText) {
    const [selector, newText] = f.dataset.replaceText.split('|');
    const el = document.querySelector(selector);
    if (!el) return;

    rememberInitialState(el);
    el.textContent = newText;
  }
  if (f.dataset.replaceImage) {
    const [selector, newSrc] = f.dataset.replaceImage.split('|');
    const el = document.querySelector(selector);
    if (!el) return;

    rememberInitialState(el);
    el.src = newSrc;
  }
  if (f.dataset.replaceVideo) {
    const [selector, newSrc] = f.dataset.replaceVideo.split('|');
    const el = document.querySelector(selector);
    if (!el) return;

    const source = el.querySelector('source');
    if (!source) return;

    rememberInitialState(el);
    source.src = newSrc;
    el.load();
    el.play();
  }
});

Reveal.on('fragmenthidden', e => {
  const f = e.fragment;

  if (f.dataset.replaceText) {
    const [selector] = f.dataset.replaceText.split('|');
    const el = document.querySelector(selector);
    if (el) restoreInitialState(el);
  }

  if (f.dataset.replaceImage) {
    const [selector] = f.dataset.replaceImage.split('|');
    const el = document.querySelector(selector);
    if (el) restoreInitialState(el);
  }

  if (f.dataset.replaceVideo) {
    const [selector] = f.dataset.replaceVideo.split('|');
    const el = document.querySelector(selector);
    if (el) restoreInitialState(el);
  }
});
</script>

<script>
  Reveal.initialize({
      
      plugins: [ 
          RevealHighlight,
           
      ],
      hash: true,
      slideNumber: true
    });
</script>


</body>
</html>
    